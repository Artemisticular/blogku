import MainGridLayout from "../layouts/MainGridLayout.astro";
import { Icon } from "astro-icon/components";
import I18nKey from "../i18n/i18nKey";
import { i18n } from "../i18n/translation";

// Daftar video yang tersedia
const videos = [
    {
        id: 1,
        title: "Video Tutorial 1",
        description: "Deskripsi video tutorial pertama",
        thumbnail: "/assets/images/video-thumb-1.jpg",
        url: "https://www.youtube.com/embed/VIDEO_ID_1",
        date: "2024-04-01"
    },
    // Tambahkan video lainnya di sini
];

// Cek status autentikasi
const isAuthenticated = Astro.cookies.get('video_access')?.value === 'true';

<MainGridLayout title="Video Tutorial" description="Koleksi video tutorial eksklusif">
    <div class="flex w-full rounded-[var(--radius-large)] overflow-hidden relative">
        <div class="card-base z-10 px-6 md:px-9 py-6 relative w-full">
            {!isAuthenticated ? (
                <div class="text-center">
                    <h1 class="text-2xl font-bold mb-4">Video Tutorial Eksklusif</h1>
                    <p class="mb-6">Masukkan kode akses untuk melihat konten video tutorial eksklusif.</p>
                    
                    <form id="accessForm" class="max-w-md mx-auto">
                        <div class="mb-4">
                            <input 
                                type="password" 
                                id="accessCode" 
                                class="w-full px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"
                                placeholder="Masukkan kode akses"
                            />
                        </div>
                        <button 
                            type="submit"
                            class="w-full btn-regular rounded-lg h-10 font-bold active:scale-95"
                        >
                            Masuk
                        </button>
                    </form>
                </div>
            ) : (
                <div>
                    <h1 class="text-2xl font-bold mb-6">Video Tutorial Eksklusif</h1>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {videos.map(video => (
                            <div class="card-base overflow-hidden">
                                <div class="aspect-video relative">
                                    <iframe 
                                        src={video.url}
                                        class="absolute inset-0 w-full h-full"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen
                                    ></iframe>
                                </div>
                                <div class="p-4">
                                    <h3 class="font-bold text-lg mb-2">{video.title}</h3>
                                    <p class="text-neutral-600 dark:text-neutral-400 text-sm mb-2">{video.description}</p>
                                    <div class="text-sm text-neutral-500">{video.date}</div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            )}
        </div>
    </div>
</MainGridLayout>

<script>
    const ACCESS_CODE = 'Artesis8192';
    const form = document.getElementById('accessForm');
    const input = document.getElementById('accessCode') as HTMLInputElement;

    form?.addEventListener('submit', (e) => {
        e.preventDefault();
        
        if (input?.value === ACCESS_CODE) {
            // Set cookie untuk autentikasi (expires dalam 7 hari)
            document.cookie = `video_access=true; path=/; max-age=${60 * 60 * 24 * 7}`;
            // Reload halaman untuk menampilkan konten
            window.location.reload();
        } else {
            alert('Kode akses salah. Silakan coba lagi.');
            input.value = '';
        }
    });
</script>

<style>
    .btn-regular {
        @apply transition flex items-center justify-center bg-[var(--card-bg)] hover:bg-[var(--btn-card-bg-hover)]
        active:bg-[var(--btn-card-bg-active)] text-[var(--primary)];
    }
</style> 